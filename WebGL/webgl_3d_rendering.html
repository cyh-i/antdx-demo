<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGL学习 - 3D计算机图形学：原理与实现</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --background-color: #f9f9f9;
            --text-color: #333;
            --code-bg: #f5f5f5;
            --border-color: #ddd;
        }
        
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 2rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        h1 {
            margin: 0;
            font-size: 2.5rem;
        }
        
        h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }
        
        h3 {
            color: var(--primary-color);
            margin-top: 1.5rem;
        }
        
        p {
            margin-bottom: 1rem;
        }
        
        .intro {
            background-color: #e8f4fc;
            border-left: 4px solid var(--secondary-color);
            padding: 1rem;
            margin-bottom: 2rem;
        }
        
        .note {
            background-color: #fff8dc;
            border-left: 4px solid #f1c40f;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        code {
            font-family: 'Courier New', Courier, monospace;
            background-color: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }
        
        .pipeline-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
        }
        
        .pipeline-table th, .pipeline-table td {
            border: 1px solid var(--border-color);
            padding: 0.8rem;
            text-align: left;
        }
        
        .pipeline-table th {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .pipeline-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .pipeline-step {
            display: flex;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .step-number {
            background-color: var(--secondary-color);
            color: white;
            padding: 1rem;
            font-weight: bold;
            min-width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .step-content {
            padding: 1rem;
            flex: 1;
        }
        
        .step-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }
        
        .image-placeholder {
            background-color: #eee;
            height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 1rem 0;
            border-radius: 5px;
            color: #777;
        }
        
        .comparison {
            display: flex;
            gap: 20px;
            margin: 2rem 0;
        }
        
        .comparison-item {
            flex: 1;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 1rem;
        }
        
        .comparison-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        
        footer {
            margin-top: 3rem;
            text-align: center;
            padding: 1rem;
            background-color: var(--primary-color);
            color: white;
        }
        
        .reference {
            font-size: 0.8rem;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>3D计算机图形学：原理与实现</h1>
            <p>WebGL学习系列 - 大局观</p>
        </div>
    </header>
    
    <div class="container">
        <section class="intro">
            <p>本章节将介绍3D计算机图形学的基本概念和工作原理，帮助您理解WebGL如何在网页浏览器中实现高性能的3D图形渲染。这些知识是学习WebGL的基础，将贯穿整个学习过程。</p>
        </section>
        
        <section>
            <h2>什么是计算机图形学？</h2>
            <p><em>计算机图形学</em>是使用计算机创建的图片和电影。在计算机中描述图片有两种基本方式：</p>
            
            <div class="comparison">
                <div class="comparison-item">
                    <div class="comparison-title">光栅图形 (Raster Graphics)</div>
                    <p>使用许多小的彩色点来描述图片。每个点称为<em>像素</em>(pixel)，是"图片元素"(picture element)的缩写。如果这些点足够小且足够紧密，人眼就不会看到单个点，而是看到一幅"图片"。</p>
                    <div class="image-placeholder">
                        <svg width="100%" height="100%" viewBox="0 0 300 150" xmlns="http://www.w3.org/2000/svg">
                            <rect x="10" y="10" width="280" height="130" fill="#fff" stroke="#ccc" />
                            <g>
                                <!-- 模拟像素网格 -->
                                <defs>
                                    <pattern id="pixel-pattern" width="10" height="10" patternUnits="userSpaceOnUse">
                                        <rect width="9" height="9" fill="#3498db" fill-opacity="0.7" />
                                    </pattern>
                                </defs>
                                <rect x="50" y="30" width="200" height="90" fill="url(#pixel-pattern)" />
                                
                                <!-- 放大镜效果 -->
                                <circle cx="220" cy="40" r="25" fill="white" stroke="#333" stroke-width="2" />
                                <g transform="translate(205, 25) scale(2)">
                                    <rect width="9" height="9" fill="#3498db" stroke="#fff" stroke-width="0.5" />
                                    <rect x="9" y="0" width="9" height="9" fill="#2980b9" stroke="#fff" stroke-width="0.5" />
                                    <rect x="0" y="9" width="9" height="9" fill="#2980b9" stroke="#fff" stroke-width="0.5" />
                                    <rect x="9" y="9" width="9" height="9" fill="#3498db" stroke="#fff" stroke-width="0.5" />
                                </g>
                                
                                <text x="150" y="140" text-anchor="middle" font-size="12" fill="#555">像素组成的图像</text>
                            </g>
                        </svg>
                    </div>
                </div>
                
                <div class="comparison-item">
                    <div class="comparison-title">矢量图形 (Vector Graphics)</div>
                    <p>使用数学方程将对象描述为几何形状。通过一个称为<em>渲染</em>的过程，从数学描述创建图片。渲染的结果是一个二维光栅图像。</p>
                    <div class="image-placeholder">
                        <svg width="100%" height="100%" viewBox="0 0 300 150" xmlns="http://www.w3.org/2000/svg">
                            <rect x="10" y="10" width="280" height="130" fill="#fff" stroke="#ccc" />
                            
                            <!-- 矢量图形示例 -->
                            <g transform="translate(150, 75)">
                                <!-- 贝塞尔曲线 -->
                                <path d="M-80,0 C-30,-50 30,-50 80,0 C30,50 -30,50 -80,0 Z" fill="#e74c3c" fill-opacity="0.7" />
                                
                                <!-- 控制点和线 -->
                                <circle cx="-80" cy="0" r="3" fill="#333" />
                                <circle cx="-30" cy="-50" r="3" fill="#333" />
                                <circle cx="30" cy="-50" r="3" fill="#333" />
                                <circle cx="80" cy="0" r="3" fill="#333" />
                                <circle cx="30" cy="50" r="3" fill="#333" />
                                <circle cx="-30" cy="50" r="3" fill="#333" />
                                
                                <line x1="-80" y1="0" x2="-30" y2="-50" stroke="#555" stroke-width="1" stroke-dasharray="3,3" />
                                <line x1="80" y1="0" x2="30" y2="-50" stroke="#555" stroke-width="1" stroke-dasharray="3,3" />
                                <line x1="80" y1="0" x2="30" y2="50" stroke="#555" stroke-width="1" stroke-dasharray="3,3" />
                                <line x1="-80" y1="0" x2="-30" y2="50" stroke="#555" stroke-width="1" stroke-dasharray="3,3" />
                            </g>
                            
                            <text x="150" y="140" text-anchor="middle" font-size="12" fill="#555">由数学方程定义的形状</text>
                        </svg>
                    </div>
                </div>
            </div>
            
            <p>计算机工具已经被开发出来用于创建和操作这两种类型的计算机图形。例如，Adobe PhotoShop是处理光栅图像的首选工具。但是，通过操作许多小的彩色点来创建新图像对于对象随时间变化的动态图像并不有利。PhotoShop非常适合创建单个图像或"修饰"现有图像，但不适合创建电影。</p>
            
            <p>计算机生成图像(CGI)是计算机图形学在艺术、印刷媒体、视频游戏、电影、电视节目、广告、视频和模拟器中创建或贡献图像的应用。普通人可能只在视频游戏和电影方面听说过CGI这个术语，但它在许多领域都有广泛的应用。</p>
        </section>
        
        <section>
            <h2>3D计算机图形学</h2>
            <p><em>3D计算机图形学</em>是使用三维几何数据表示进行计算并渲染2D图像的图形。本教程将帮助您学习如何使用3D计算机图形技术创建CGI。换句话说，这些教程将帮助您创建三维对象的矢量图形表示，然后将它们渲染成光栅图像。</p>
            
            <p>如果您能创建数据和算法，在不到1/30秒的时间内渲染光栅图像，您就可以创建观众观看时实时渲染的<em>实时</em>视频。大多数视频游戏都基于<em>实时</em>渲染。如果创建每个图像需要超过1/30秒，您总是可以存储图像并实时回放它们。大多数电影CGI不是实时渲染的。</p>
            
            <div class="note">
                <p><strong>注意：</strong>WebGL是一种JavaScript API，允许程序员在网页浏览器窗口中使用计算设备的图形处理单元(GPU)渲染实时3D计算机图形。它是当今软件行业唯一的跨平台3D计算机图形开发环境。学习WebGL是理解计算机图形基础知识的最佳方式，同时也能掌握一个可以用来制作自己的计算机图形的"工具箱"。</p>
            </div>
        </section>
        
        <section>
            <h2>图形渲染管线</h2>
            <p>将对象的矢量图形表示转换为光栅图像的过程通过以下步骤执行：</p>
            
            <div class="pipeline-step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <div class="step-title">输入数据</div>
                    <p>将数据输入管线，包括定义位置的模型顶点(x,y,z)、定义方向的法向量(dx,dy,dz)和颜色数据。</p>
                    <p><strong>执行者：</strong> CPU: JavaScript代码</p>
                    <svg width="100%" height="80" viewBox="0 0 300 80" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="280" height="60" fill="#f8f9fa" stroke="#ddd" rx="3" />
                        
                        <!-- 数据表示 -->
                        <g transform="translate(30, 40)">
                            <!-- 顶点数据 -->
                            <rect x="0" y="-20" width="60" height="40" fill="#3498db" fill-opacity="0.3" stroke="#3498db" />
                            <text x="30" y="5" text-anchor="middle" font-size="10">顶点坐标</text>
                            
                            <!-- 法线数据 -->
                            <rect x="80" y="-20" width="60" height="40" fill="#2ecc71" fill-opacity="0.3" stroke="#2ecc71" />
                            <text x="110" y="5" text-anchor="middle" font-size="10">法线向量</text>
                            
                            <!-- 颜色数据 -->
                            <rect x="160" y="-20" width="60" height="40" fill="#e74c3c" fill-opacity="0.3" stroke="#e74c3c" />
                            <text x="190" y="5" text-anchor="middle" font-size="10">颜色数据</text>
                            
                            <!-- 箭头指向管线 -->
                            <path d="M240,0 L260,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                        </g>
                        
                        <defs>
                            <marker id="pipeline-arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                <path d="M0,0 L0,6 L9,3 z" fill="#555" />
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
            
            <div class="pipeline-step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <div class="step-title">模型变换</div>
                    <p>平移、缩放和旋转模型到3D场景中所需的位置和方向。然后将所有内容移到摄像机前面。</p>
                    <p><strong>执行者：</strong> CPU: JavaScript代码 GPU: 顶点着色器</p>
                    <svg width="100%" height="80" viewBox="0 0 300 80" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="280" height="60" fill="#f8f9fa" stroke="#ddd" rx="3" />
                        
                        <!-- 模型变换示意图 -->
                        <g transform="translate(40, 40)">
                            <!-- 原始立方体 -->
                            <g transform="scale(0.7)">
                                <path d="M-20,-20 L20,-20 L20,20 L-20,20 Z" fill="#3498db" fill-opacity="0.3" stroke="#3498db" />
                            </g>
                            
                            <!-- 变换箭头 -->
                            <path d="M30,0 L70,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                            <text x="50" y="-10" text-anchor="middle" font-size="10">变换</text>
                            
                            <!-- 变换后的立方体 -->
                            <g transform="translate(100, 0) scale(0.9) rotate(30)">
                                <path d="M-20,-20 L20,-20 L20,20 L-20,20 Z" fill="#3498db" fill-opacity="0.5" stroke="#3498db" />
                            </g>
                            
                            <!-- 变换矩阵示意 -->
                            <g transform="translate(160, 0)">
                                <rect x="-20" y="-20" width="40" height="40" fill="#f1c40f" fill-opacity="0.2" stroke="#f1c40f" />
                                <text x="0" y="5" text-anchor="middle" font-size="10">变换矩阵</text>
                            </g>
                        </g>
                    </svg>
                </div>
            </div>
            
            <div class="pipeline-step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <div class="step-title">投影变换</div>
                    <p>将3D世界投影到2D观看屏幕上。</p>
                    <p><strong>执行者：</strong> CPU: JavaScript代码 GPU: 顶点着色器</p>
                    <svg width="100%" height="80" viewBox="0 0 300 80" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="280" height="60" fill="#f8f9fa" stroke="#ddd" rx="3" />
                        
                        <!-- 投影变换示意图 -->
                        <g transform="translate(40, 40)">
                            <!-- 3D空间中的立方体 -->
                            <g transform="rotate(15)">
                                <path d="M-20,-20 L20,-20 L20,20 L-20,20 Z" fill="#3498db" fill-opacity="0.3" stroke="#3498db" />
                                <path d="M-20,-20 L-10,-30 L30,-30 L20,-20" fill="#3498db" fill-opacity="0.2" stroke="#3498db" />
                                <path d="M20,-20 L30,-30 L30,10 L20,20" fill="#3498db" fill-opacity="0.4" stroke="#3498db" />
                            </g>
                            
                            <!-- 投影线 -->
                            <path d="M40,0 L80,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                            <text x="60" y="-10" text-anchor="middle" font-size="10">投影</text>
                            
                            <!-- 投影后的2D图像 -->
                            <g transform="translate(120, 0)">
                                <rect x="-30" y="-25" width="60" height="50" fill="#3498db" fill-opacity="0.5" stroke="#3498db" />
                            </g>
                            
                            <!-- 投影矩阵示意 -->
                            <g transform="translate(180, 0)">
                                <rect x="-20" y="-20" width="40" height="40" fill="#9b59b6" fill-opacity="0.2" stroke="#9b59b6" />
                                <text x="0" y="5" text-anchor="middle" font-size="10">投影矩阵</text>
                            </g>
                        </g>
                    </svg>
                </div>
            </div>
            
            <div class="pipeline-step">
                <div class="step-number">4</div>
                <div class="step-content">
                    <div class="step-title">规范化</div>
                    <p>剪裁掉不在摄像机视野范围内的所有内容。</p>
                    <p><strong>执行者：</strong> CPU: JavaScript代码 GPU: 顶点着色器</p>
                    <svg width="100%" height="80" viewBox="0 0 300 80" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="280" height="60" fill="#f8f9fa" stroke="#ddd" rx="3" />
                        
                        <!-- 规范化示意图 -->
                        <g transform="translate(40, 40)">
                            <!-- 视锥体 -->
                            <path d="M-30,-25 L30,-25 L60,25 L-60,25 Z" fill="none" stroke="#555" stroke-dasharray="3,3" />
                            
                            <!-- 在视锥体内的对象 -->
                            <circle cx="0" cy="0" r="15" fill="#3498db" fill-opacity="0.5" stroke="#3498db" />
                            
                            <!-- 在视锥体外的对象 -->
                            <circle cx="-50" cy="-15" r="10" fill="#e74c3c" fill-opacity="0.5" stroke="#e74c3c" />
                            <circle cx="45" cy="15" r="12" fill="#e74c3c" fill-opacity="0.5" stroke="#e74c3c" />
                            
                            <!-- 剪裁示意 -->
                            <path d="M80,0 L120,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                            <text x="100" y="-10" text-anchor="middle" font-size="10">剪裁</text>
                            
                            <!-- 剪裁后的结果 -->
                            <g transform="translate(160, 0)">
                                <path d="M-30,-25 L30,-25 L60,25 L-60,25 Z" fill="none" stroke="#555" stroke-dasharray="3,3" />
                                <circle cx="0" cy="0" r="15" fill="#3498db" fill-opacity="0.5" stroke="#3498db" />
                            </g>
                        </g>
                    </svg>
                </div>
            </div>
            
            <div class="pipeline-step">
                <div class="step-number">5</div>
                <div class="step-content">
                    <div class="step-title">视口变换</div>
                    <p>将3D对象坐标映射到光栅图像的像素坐标中。</p>
                    <p><strong>执行者：</strong> GPU: 固定功能</p>
                    <svg width="100%" height="80" viewBox="0 0 300 80" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="280" height="60" fill="#f8f9fa" stroke="#ddd" rx="3" />
                        
                        <!-- 视口变换示意图 -->
                        <g transform="translate(40, 40)">
                            <!-- 规范化设备坐标系 -->
                            <rect x="-30" y="-20" width="60" height="40" fill="none" stroke="#555" />
                            <circle cx="0" cy="0" r="15" fill="#3498db" fill-opacity="0.3" stroke="#3498db" />
                            
                            <!-- 变换箭头 -->
                            <path d="M40,0 L80,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                            <text x="60" y="-10" text-anchor="middle" font-size="10">视口变换</text>
                            
                            <!-- 屏幕坐标系 -->
                            <g transform="translate(120, 0)">
                                <rect x="-30" y="-20" width="60" height="40" fill="#f5f5f5" stroke="#555" />
                                <text x="-25" y="-10" font-size="8">(0,0)</text>
                                <text x="15" y="15" font-size="8">(w,h)</text>
                                <circle cx="0" cy="0" r="15" fill="#3498db" fill-opacity="0.5" stroke="#3498db" />
                            </g>
                            
                            <!-- 视口矩阵示意 -->
                            <g transform="translate(180, 0)">
                                <rect x="-20" y="-20" width="40" height="40" fill="#1abc9c" fill-opacity="0.2" stroke="#1abc9c" />
                                <text x="0" y="5" text-anchor="middle" font-size="10">视口矩阵</text>
                            </g>
                        </g>
                    </svg>
                </div>
            </div>
            
            <div class="pipeline-step">
                <div class="step-number">6</div>
                <div class="step-content">
                    <div class="step-title">光栅化</div>
                    <p>确定每个对象(点、线或三角形)覆盖哪些像素，并丢弃被其他对象遮挡的对象。</p>
                    <p><strong>执行者：</strong> GPU: 固定功能</p>
                    <svg width="100%" height="80" viewBox="0 0 300 80" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="280" height="60" fill="#f8f9fa" stroke="#ddd" rx="3" />
                        
                        <!-- 光栅化示意图 -->
                        <g transform="translate(30, 40)">
                            <!-- 三角形 -->
                            <path d="M0,-20 L30,15 L-30,15 Z" fill="#3498db" fill-opacity="0.5" stroke="#3498db" />
                            
                            <!-- 变换箭头 -->
                            <path d="M40,0 L70,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                            <text x="55" y="-10" text-anchor="middle" font-size="10">光栅化</text>
                            
                            <!-- 像素网格 -->
                            <g transform="translate(100, 0)">
                                <defs>
                                    <pattern id="pixel-grid" width="10" height="10" patternUnits="userSpaceOnUse">
                                        <rect width="10" height="10" fill="none" stroke="#ccc" stroke-width="0.5" />
                                    </pattern>
                                </defs>
                                <rect x="-30" y="-20" width="60" height="40" fill="url(#pixel-grid)" />
                                
                                <!-- 填充的像素 -->
                                <rect x="-30" y="10" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                <rect x="-20" y="10" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                <rect x="-10" y="10" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                <rect x="0" y="10" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                <rect x="10" y="10" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                <rect x="20" y="10" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                
                                <rect x="-20" y="0" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                <rect x="-10" y="0" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                <rect x="0" y="0" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                <rect x="10" y="0" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                
                                <rect x="-10" y="-10" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                <rect x="0" y="-10" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                                
                                <rect x="0" y="-20" width="10" height="10" fill="#3498db" fill-opacity="0.5" />
                            </g>
                            
                            <!-- 深度测试示意 -->
                            <g transform="translate(170, 0)">
                                <rect x="-20" y="-20" width="40" height="40" fill="#95a5a6" fill-opacity="0.2" stroke="#95a5a6" />
                                <text x="0" y="-5" text-anchor="middle" font-size="8">深度测试</text>
                                <text x="0" y="5" text-anchor="middle" font-size="8">隐藏面消除</text>
                            </g>
                            
                            <path d="M200,0 L220,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                        </g>
                    </svg>
                </div>
            </div>
            
            <div class="pipeline-step">
                <div class="step-number">7</div>
                <div class="step-content">
                    <div class="step-title">着色</div>
                    <p>确定表示对象的每个像素的颜色。</p>
                    <p><strong>执行者：</strong> CPU: JavaScript代码 GPU: 片段着色器</p>
                    <svg width="100%" height="80" viewBox="0 0 300 80" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="280" height="60" fill="#f8f9fa" stroke="#ddd" rx="3" />
                        
                        <!-- 着色示意图 -->
                        <g transform="translate(40, 40)">
                            <!-- 光栅化后的三角形 -->
                            <g>
                                <rect x="-30" y="-20" width="60" height="40" fill="url(#pixel-grid)" />
                                <path d="M0,-20 L30,15 L-30,15 Z" fill="#ccc" fill-opacity="0.5" stroke="#ccc" />
                            </g>
                            
                            <!-- 着色箭头 -->
                            <path d="M40,0 L80,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                            <text x="60" y="-10" text-anchor="middle" font-size="10">着色</text>
                            
                            <!-- 着色后的三角形 -->
                            <g transform="translate(120, 0)">
                                <rect x="-30" y="-20" width="60" height="40" fill="url(#pixel-grid)" />
                                <linearGradient id="triangle-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" stop-color="#3498db" />
                                    <stop offset="100%" stop-color="#9b59b6" />
                                </linearGradient>
                                <path d="M0,-20 L30,15 L-30,15 Z" fill="url(#triangle-gradient)" fill-opacity="0.8" stroke="#555" />
                            </g>
                        </g>
                    </svg>
                </div>
            </div>
            
            <div class="pipeline-step">
                <div class="step-number">8</div>
                <div class="step-content">
                    <div class="step-title">合成</div>
                    <p>将像素的颜色添加到光栅图像中，可能将颜色与已经在图像中的颜色结合起来。</p>
                    <p><strong>执行者：</strong> GPU: 固定功能</p>
                    <svg width="100%" height="80" viewBox="0 0 300 80" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="280" height="60" fill="#f8f9fa" stroke="#ddd" rx="3" />
                        
                        <!-- 合成示意图 -->
                        <g transform="translate(30, 40)">
                            <!-- 背景图像 -->
                            <rect x="-20" y="-20" width="40" height="40" fill="#ecf0f1" stroke="#bdc3c7" />
                            <circle cx="-5" cy="-5" r="8" fill="#e74c3c" fill-opacity="0.7" />
                            
                            <!-- 前景图像 -->
                            <g transform="translate(60, 0)">
                                <rect x="-20" y="-20" width="40" height="40" fill="#f5f5f5" stroke="#bdc3c7" />
                                <circle cx="5" cy="5" r="10" fill="#3498db" fill-opacity="0.7" />
                            </g>
                            
                            <!-- 合成箭头 -->
                            <path d="M30,0 L50,0" stroke="#555" stroke-width="1.5" />
                            <path d="M90,0 L110,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                            <text x="80" y="-10" text-anchor="middle" font-size="10">合成</text>
                            
                            <!-- 合成后的图像 -->
                            <g transform="translate(140, 0)">
                                <rect x="-20" y="-20" width="40" height="40" fill="#ecf0f1" stroke="#bdc3c7" />
                                <circle cx="-5" cy="-5" r="8" fill="#e74c3c" fill-opacity="0.7" />
                                <circle cx="5" cy="5" r="10" fill="#3498db" fill-opacity="0.7" />
                            </g>
                            
                            <!-- Alpha混合示意 -->
                            <g transform="translate(190, 0)">
                                <rect x="-20" y="-20" width="40" height="40" fill="#f39c12" fill-opacity="0.2" stroke="#f39c12" />
                                <text x="0" y="5" text-anchor="middle" font-size="10">Alpha混合</text>
                            </g>
                        </g>
                    </svg>
                </div>
            </div>
            
            <div class="pipeline-step">
                <div class="step-number">9</div>
                <div class="step-content">
                    <div class="step-title">输出</div>
                    <p>输出光栅图像，图像的每个像素一个颜色值。</p>
                    <p><strong>执行者：</strong> GPU: 固定功能</p>
                    <svg width="100%" height="80" viewBox="0 0 300 80" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="280" height="60" fill="#f8f9fa" stroke="#ddd" rx="3" />
                        
                        <!-- 输出示意图 -->
                        <g transform="translate(40, 40)">
                            <!-- 帧缓冲区 -->
                            <rect x="-30" y="-20" width="60" height="40" fill="#ecf0f1" stroke="#bdc3c7" />
                            <circle cx="-10" cy="-5" r="8" fill="#e74c3c" fill-opacity="0.7" />
                            <circle cx="10" cy="5" r="10" fill="#3498db" fill-opacity="0.7" />
                            <path d="M-15,15 L15,-15" stroke="#2ecc71" stroke-width="2" />
                            
                            <!-- 输出箭头 -->
                            <path d="M40,0 L80,0" stroke="#555" stroke-width="1.5" marker-end="url(#pipeline-arrow)" />
                            <text x="60" y="-10" text-anchor="middle" font-size="10">显示</text>
                            
                            <!-- 显示器 -->
                            <g transform="translate(120, 0)">
                                <rect x="-30" y="-20" width="60" height="40" fill="#ecf0f1" stroke="#555" stroke-width="2" />
                                <rect x="-28" y="-18" width="56" height="36" fill="#ecf0f1" />
                                <circle cx="-10" cy="-5" r="8" fill="#e74c3c" fill-opacity="0.7" />
                                <circle cx="10" cy="5" r="10" fill="#3498db" fill-opacity="0.7" />
                                <path d="M-15,15 L15,-15" stroke="#2ecc71" stroke-width="2" />
                                <rect x="-10" y="20" width="20" height="5" fill="#555" />
                            </g>
                        </g>
                    </svg>
                </div>
            </div>
            
            <div class="note">
                <p>上述每个步骤的详细内容将在后续教程中解释。在深入细节时，请经常参考这个概述，以保持对整体图景的理解。</p>
            </div>
        </section>
        
        <section>
            <h2>WebGL渲染步骤</h2>
            <p>每次渲染场景时，您的JavaScript程序必须执行以下步骤：</p>
            
            <ol>
                <li>将保存渲染结果的颜色缓冲区清除为背景色。</li>
                <li>如果您正在进行<em>隐藏面消除</em>，清除<em>深度缓冲区</em>。</li>
                <li>选择您的着色器程序。</li>
                <li>对于场景中的每个模型：
                    <ol>
                        <li>将<code>uniform</code>变量的值传递给着色器程序。</li>
                        <li>将每个<code>attribute</code>变量附加到适当的<em>缓冲区对象</em>。</li>
                        <li>调用WebGL <code>gl.drawArrays()</code>函数。</li>
                    </ol>
                </li>
            </ol>
            
            <div class="image-placeholder">
                <svg width="100%" height="100%" viewBox="0 0 600 150" xmlns="http://www.w3.org/2000/svg">
                    <rect x="10" y="10" width="580" height="130" fill="#fff" stroke="#ccc" />
                    
                    <!-- 渲染步骤流程图 -->
                    <g transform="translate(30, 30)">
                        <!-- 清除缓冲区 -->
                        <rect x="0" y="0" width="100" height="40" rx="5" fill="#3498db" />
                        <text x="50" y="25" text-anchor="middle" fill="white" font-size="12">清除缓冲区</text>
                        
                        <!-- 选择着色器 -->
                        <rect x="130" y="0" width="100" height="40" rx="5" fill="#3498db" />
                        <text x="180" y="25" text-anchor="middle" fill="white" font-size="12">选择着色器程序</text>
                        
                        <!-- 模型循环 -->
                        <rect x="260" y="0" width="280" height="40" rx="5" fill="#3498db" />
                        <text x="400" y="25" text-anchor="middle" fill="white" font-size="12">对每个模型设置参数并绘制</text>
                        
                        <!-- 连接箭头 -->
                        <path d="M100,20 L130,20" stroke="#555" stroke-width="2" marker-end="url(#arrow)" />
                        <path d="M230,20 L260,20" stroke="#555" stroke-width="2" marker-end="url(#arrow)" />
                        
                        <!-- 详细步骤 -->
                        <rect x="260" y="60" width="80" height="30" rx="3" fill="#e74c3c" />
                        <text x="300" y="80" text-anchor="middle" fill="white" font-size="10">设置uniform变量</text>
                        
                        <rect x="360" y="60" width="80" height="30" rx="3" fill="#e74c3c" />
                        <text x="400" y="80" text-anchor="middle" fill="white" font-size="10">绑定attribute</text>
                        
                        <rect x="460" y="60" width="80" height="30" rx="3" fill="#e74c3c" />
                        <text x="500" y="80" text-anchor="middle" fill="white" font-size="10">调用drawArrays</text>
                        
                        <!-- 连接线 -->
                        <path d="M300,40 L300,60" stroke="#555" stroke-width="1" />
                        <path d="M400,40 L400,60" stroke="#555" stroke-width="1" />
                        <path d="M500,40 L500,60" stroke="#555" stroke-width="1" />
                    </g>
                    
                    <!-- 箭头定义 -->
                    <defs>
                        <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#555" />
                        </marker>
                    </defs>
                </svg>
            </div>
            
            <p>这些渲染步骤中有很多内容。后续课程将涵盖所有细节。</p>
        </section>
        
        <section>
            <h2>WebGL程序的预处理与渲染</h2>
            <p>在计算机图形学中，一个基本原则是昂贵的操作只执行一次。在这些教程中，您将不断看到"预处理步骤"和"渲染步骤"这两个短语。目标是只执行一次"预处理步骤"。因此，执行图形渲染的JavaScript代码通常分为两个独立的部分：</p>
            
            <ol>
                <li><strong>设置(或预处理)部分</strong> - 只执行一次</li>
                <li><strong>渲染部分</strong> - 每次绘制对象时执行</li>
            </ol>
            
            <p>每个教程课程都将明确区分预处理代码和渲染代码。</p>
            
            <div class="note">
                <p>请记住，JavaScript代码在CPU上运行，而图形渲染由GPU完成。JavaScript代码是"主人"，它"运行整个过程"并告诉GPU何时以及渲染什么。</p>
            </div>
            
            <div class="image-placeholder">
                <svg width="100%" height="100%" viewBox="0 0 600 150" xmlns="http://www.w3.org/2000/svg">
                    <rect x="10" y="10" width="580" height="130" fill="#fff" stroke="#ccc" />
                    
                    <!-- WebGL程序各部分的存储和执行位置 -->
                    <g>
                        <!-- CPU部分 -->
                        <rect x="50" y="30" width="200" height="90" rx="5" fill="#3498db" fill-opacity="0.2" stroke="#3498db" />
                        <text x="150" y="25" text-anchor="middle" font-size="14" fill="#3498db">CPU (JavaScript)</text>
                        
                        <!-- GPU部分 -->
                        <rect x="350" y="30" width="200" height="90" rx="5" fill="#e74c3c" fill-opacity="0.2" stroke="#e74c3c" />
                        <text x="450" y="25" text-anchor="middle" font-size="14" fill="#e74c3c">GPU (WebGL)</text>
                        
                        <!-- CPU内容 -->
                        <text x="150" y="55" text-anchor="middle" font-size="12" fill="#333">预处理步骤 (执行一次)</text>
                        <text x="150" y="75" text-anchor="middle" font-size="10" fill="#555">• 加载模型数据</text>
                        <text x="150" y="95" text-anchor="middle" font-size="10" fill="#555">• 创建着色器程序</text>
                        <text x="150" y="115" text-anchor="middle" font-size="10" fill="#555">• 设置事件处理</text>
                        
                        <!-- GPU内容 -->
                        <text x="450" y="55" text-anchor="middle" font-size="12" fill="#333">渲染步骤 (每帧执行)</text>
                        <text x="450" y="75" text-anchor="middle" font-size="10" fill="#555">• 顶点着色器处理</text>
                        <text x="450" y="95" text-anchor="middle" font-size="10" fill="#555">• 片段着色器处理</text>
                        <text x="450" y="115" text-anchor="middle" font-size="10" fill="#555">• 光栅化和输出</text>
                        
                        <!-- 连接箭头 -->
                        <path d="M250,60 L350,60" stroke="#555" stroke-width="1.5" marker-end="url(#arrow2)" />
                        <path d="M350,100 L250,100" stroke="#555" stroke-width="1.5" marker-end="url(#arrow2)" />
                        
                        <text x="300" y="50" text-anchor="middle" font-size="10" fill="#555">命令和数据</text>
                        <text x="300" y="115" text-anchor="middle" font-size="10" fill="#555">渲染结果</text>
                    </g>
                    
                    <!-- 箭头定义 -->
                    <defs>
                        <marker id="arrow2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#555" />
                        </marker>
                    </defs>
                </svg>
            </div>
        </section>
        
        <section class="reference">
            <h3>参考资料</h3>
            <ol>
                <li>本教程改编自 <a href="https://learnwebgl.brown37.net/the_big_picture/3d_rendering.html" target="_blank">LearnWebGL - 3D Computer Graphics - What and How</a></li>
                <li>更多WebGL学习资源可访问 <a href="https://learnwebgl.brown37.net/" target="_blank">LearnWebGL</a></li>
            </ol>
        </section>
    </div>
    
    <footer>
        <div class="container">
            <p>WebGL学习系列 &copy; 2023</p>
        </div>
    </footer>
</body>
</html> 